# TMUX.CONF
# =========

# =======================
# Aesthetic configuration
# =======================
  # ----------
  # Status bar
  # ----------
    set -g status-position top
  # ------------
  # Window title
  # ------------
    set -g automatic-rename on
    set -g set-titles on
    set -g set-titles-string "#{session_name}:#{window_index}:#{window_name}"
  # ------------------
  # True-color support
  # ------------------
    set -g default-terminal "tmux-256color"
    set -ga terminal-overrides ",xterm-256color:RGB"
  # ----------
  # Undercurls
  # ----------
    set -ga terminal-overrides ',*:Smulx=\E[4::%p1%dm'
    set -ga terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# ======================
# Terminal configuration
# ======================
  # -----------------------
  # Clipboard configuration
  # -----------------------
    set -g set-clipboard on
  # -------------------
  # Mouse configuration
  # -------------------
    set -g mouse on
  # --------------------
  # Timing configuration
  # --------------------
    set -g repeat-time 400
  # ----------
  # xterm keys
  # ----------
    set -g xterm-keys on
  # -------------
  # CSI u support
  # -------------
    set -g extended-keys on

# =========================
# Multiplexor configuration
# =========================
  # --------------------
  # Window configuration
  # --------------------
    # Start window numbering at 1
    set -g base-index 1
    # Start pane numbering at 1
    set -g pane-base-index 1
    # Renumber windows when a window is closed
    set -g renumber-windows on
  # ----------------------
  # Activity configuration
  # ----------------------
    set -g monitor-activity on
    set -g visual-activity off
    set -g bell-action none
    set -g visual-bell off
    set -g visual-silence off
  # ---------------------
  # Session configuration
  # ---------------------
    set -g detach-on-destroy off

# ============
# Key Bindings
# ============
  # ------
  # Prefix
  # ------
    set -g prefix C-b
  # -------------------
  # Enable VIM keybinds
  # -------------------
    set -g mode-keys vi
    set -g status-keys vi
  # --------------------
  # NORMAL mode keybinds
  # --------------------
    # Reload configuration
    bind -n M-r { source ~/.config/tmux/tmux.conf; display "Configuration reloaded..." }
    # Move between panes with arrows
    bind -n M-S-Left { select-pane -L; }
    bind -n M-S-Up { select-pane -U; }
    bind -n M-S-Right { select-pane -R; }
    bind -n M-S-Down { select-pane -D; }
    # Move between panes with hjkl
    bind -n M-H { select-pane -L; }
    bind -n M-K { select-pane -U; }
    bind -n M-L { select-pane -R; }
    bind -n M-J { select-pane -D; }
    # Move between windows
    bind -n M-[ { previous-window; }
    bind -n M-] { next-window; }
    bind -n M-\{ { previous-window; }
    bind -n M-\} { next-window; }
    # Go to window by number
    bind -n M-1 { select-window -t 1; }
    bind -n M-2 { select-window -t 2; }
    bind -n M-3 { select-window -t 3; }
    bind -n M-4 { select-window -t 4; }
    bind -n M-5 { select-window -t 5; }
    bind -n M-6 { select-window -t 6; }
    bind -n M-7 { select-window -t 7; }
    bind -n M-8 { select-window -t 8; }
    bind -n M-9 { select-window -t 9; }
    # Choose a session
    bind -n M-s { choose-tree -s; }
    # Create a new pane
    bind -n M-n { split-pane -v -c "#{pane_current_path}"; }
    bind -n M-N { split-pane -h -c "#{pane_current_path}"; }
    # Zoom into pane
    bind -n M-z { resize-pane -Z; }
    # Close the current pane
    bind -n M-q { kill-pane; }
    bind -n M-x { kill-pane; }
    # Enter command mode
    bind -n M-: { command-prompt; }
  # ------------------
  # Pane mode keybinds
  # ------------------
    bind -n M-w { switch-client -Tpane; }
    # Move between panes with arrows
    bind -Tpane Left { select-pane -L; switch-client -Tpane; }
    bind -Tpane Up { select-pane -U; switch-client -Tpane; }
    bind -Tpane Right { select-pane -R; switch-client -Tpane; }
    bind -Tpane Down { select-pane -D; switch-client -Tpane; }
    # Move between panes with hjkl
    bind -Tpane h { select-pane -L; switch-client -Tpane; }
    bind -Tpane k { select-pane -U; switch-client -Tpane; }
    bind -Tpane l { select-pane -R; switch-client -Tpane; }
    bind -Tpane j { select-pane -D; switch-client -Tpane; }
    # Close the current pane
    bind -Tpane q { kill-pane; }
    bind -Tpane x { kill-pane; }
    # Create a new pane
    bind -Tpane s { split-pane -v -c "#{pane_current_path}"; }
    bind -Tpane v { split-pane -h -c "#{pane_current_path}"; }
    # Zoom into pane
    bind -Tpane z { resize-pane -Z; }
  # --------------------
  # Resize mode keybinds
  # --------------------
    bind -n M-W { switch-client -Tresize; }
    bind -Tresize Left { resize-pane -L 2; switch-client -Tresize; }
    bind -Tresize Up { resize-pane -U; switch-client -Tresize; }
    bind -Tresize Right { resize-pane -R 2; switch-client -Tresize; }
    bind -Tresize Down { resize-pane -D; switch-client -Tresize; }
    bind -Tresize h { resize-pane -L 2; switch-client -Tresize; }
    bind -Tresize k { resize-pane -U; switch-client -Tresize; }
    bind -Tresize l { resize-pane -R 2; switch-client -Tresize; }
    bind -Tresize j { resize-pane -D; switch-client -Tresize; }
  # --------------------
  # Window mode keybinds
  # --------------------
    bind -n M-t { switch-client -Twindow; }
    # Move between windows
    bind -Twindow [ { previous-window; switch-client -Twindow; }
    bind -Twindow ] { next-window; switch-client -Twindow; }
    bind -Twindow \{ { previous-window; switch-client -Twindow; }
    bind -Twindow \} { next-window; switch-client -Twindow; }
    # Go to window by number
    bind -Twindow 1 { select-window -t 1; switch-client -Twindow; }
    bind -Twindow 2 { select-window -t 2; switch-client -Twindow; }
    bind -Twindow 3 { select-window -t 3; switch-client -Twindow; }
    bind -Twindow 4 { select-window -t 4; switch-client -Twindow; }
    bind -Twindow 5 { select-window -t 5; switch-client -Twindow; }
    bind -Twindow 6 { select-window -t 6; switch-client -Twindow; }
    bind -Twindow 7 { select-window -t 7; switch-client -Twindow; }
    bind -Twindow 8 { select-window -t 8; switch-client -Twindow; }
    bind -Twindow 9 { select-window -t 9; switch-client -Twindow; }
    # Create a new window
    bind -Twindow n { new-window -c "#{pane_current_path}"; }
    # Close the current window
    bind -Twindow q { kill-window; }
    bind -Twindow x { kill-window; }
    # Rename the current window
    bind -Twindow r { command-prompt "rename-window %%"; }
  # ---------------------
  # Session mode keybinds
  # ---------------------
    bind -n M-S { switch-client -Tsession; }
    # Rename the current session
    bind -Tsession r { command-prompt "rename-session %%"; }
    # Create a new session
    bind -Tsession n { command-prompt "new-session -A -s %%"; }
    # Close the current session
    bind -Tsession q { kill-session; }
    bind -Tsession x { kill-session; }

# =======
# Plugins
# =======
  set -g @plugin 'tmux-plugins/tpm'
  set -g @plugin 'tmux-plugins/tmux-sensible'
  set -g @plugin 'nhdaly/tmux-better-mouse-mode'
  set -g @plugin 'tmux-plugins/tmux-yank'
  set -g @plugin 'tmux-plugins/tmux-resurrect'
  set -g @plugin 'tmux-plugins/tmux-continuum'
  set -g @plugin 'catppuccin/tmux'

# ====================
# Plugin configuration
# ====================
  # --------------
  # tmux-continuum
  # --------------
    set -g @continuum-restore 'on'

# ============
# Finalization
# ============
  # -------------------
  # $PATH configuration
  # -------------------
    # Add MacOS ARM Homebrew binaries to $PATH
    if "[ -d '/opt/homebrew/bin/' ]" {
      setenv -g PATH "/opt/homebrew/bin:$PATH"
    }
  # ------------------
  # TPM Initialization
  # ------------------
    # Execute Tmux Package Manager
    run '~/.config/tmux/plugins/tpm/tpm'
